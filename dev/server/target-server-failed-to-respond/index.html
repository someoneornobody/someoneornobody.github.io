<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<title>
          
            
              The target server failed to respond (And.. HTTP/1.0, HTTP/1.1)
            
          
        </title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="최근 외부업체와의 통신 중에 아래와 같은 오류가 매우 자주 발생하는 것을 확인 할 수 있었습니다.The target server failed to respond먼저 본문 포스트를 작성 하기 전에 위의 오류에 대한 해결은 아직 하지 못하였으며 아래는 HTTP/1.0, HTTP/1.1 에 관한 간략한 내용을 담는 글이라고 먼저 말씀드립니다. 해당 오류가 해결이 된다면 바로 본문 게시글을 수정하도록 하겠습니다.The target server failed to respond.해당 오류는 HttpClient 방식을 통해 통신을 하는 중에 발생을 하였으며, 발견 당시 해당 오류에 대한 검색을 해보았습니다.그러던 중 접한 정보가 HTTP 통신 규약인 HTTP/1.0 과 HTTP/1.1 입니다. 아래 해당 내용에 대해..">
	<meta name="keywords" content="[서버오류 통신오류 CLOSE_WAIT Connection http/1.0 http/1.1 keep-alive httpClient 통신규격 server failed]">

	
	
	  <meta name="naver-site-verification" content="439f59aba127ab6f3090f6d4a52855af8d1e66fa" /> 
	

        
        
        
        
        
        
        
        

	
		    
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-WHXPGVQXNY');
</script>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-WHXPGVQXNY"></script>
        

        
        <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-8964630540815976" crossorigin="anonymous"></script>
        
		<meta property="og:url" content="https://someoneornobody.github.io/dev/server/target-server-failed-to-respond/">
  <meta property="og:site_name" content="국내 이곳저곳 여행지 및 카페, 아이와 함께 갈만한 곳을 소개합니다.">
  <meta property="og:title" content="The target server failed to respond (And.. HTTP/1.0, HTTP/1.1)">
  <meta property="og:description" content="최근 외부업체와의 통신 중에 아래와 같은 오류가 매우 자주 발생하는 것을 확인 할 수 있었습니다.The target server failed to respond먼저 본문 포스트를 작성 하기 전에 위의 오류에 대한 해결은 아직 하지 못하였으며 아래는 HTTP/1.0, HTTP/1.1 에 관한 간략한 내용을 담는 글이라고 먼저 말씀드립니다. 해당 오류가 해결이 된다면 바로 본문 게시글을 수정하도록 하겠습니다.The target server failed to respond.해당 오류는 HttpClient 방식을 통해 통신을 하는 중에 발생을 하였으며, 발견 당시 해당 오류에 대한 검색을 해보았습니다.그러던 중 접한 정보가 HTTP 통신 규약인 HTTP/1.0 과 HTTP/1.1 입니다. 아래 해당 내용에 대해..">
  <meta property="og:locale" content="ko_kr">
  <meta property="og:type" content="article">
    <meta property="article:section" content="dev">
    <meta property="article:published_time" content="2024-10-30T09:35:41+09:00">
    <meta property="article:modified_time" content="2024-10-30T09:35:41+09:00">
    <meta property="article:tag" content="CLOSE_WAIT">
    <meta property="article:tag" content="Connection">
    <meta property="article:tag" content="Http/1.0">
    <meta property="article:tag" content="Http/1.1">
    <meta property="article:tag" content="Keep-Alive">

		
  <meta itemprop="name" content="The target server failed to respond (And.. HTTP/1.0, HTTP/1.1)">
  <meta itemprop="description" content="최근 외부업체와의 통신 중에 아래와 같은 오류가 매우 자주 발생하는 것을 확인 할 수 있었습니다.The target server failed to respond먼저 본문 포스트를 작성 하기 전에 위의 오류에 대한 해결은 아직 하지 못하였으며 아래는 HTTP/1.0, HTTP/1.1 에 관한 간략한 내용을 담는 글이라고 먼저 말씀드립니다. 해당 오류가 해결이 된다면 바로 본문 게시글을 수정하도록 하겠습니다.The target server failed to respond.해당 오류는 HttpClient 방식을 통해 통신을 하는 중에 발생을 하였으며, 발견 당시 해당 오류에 대한 검색을 해보았습니다.그러던 중 접한 정보가 HTTP 통신 규약인 HTTP/1.0 과 HTTP/1.1 입니다. 아래 해당 내용에 대해..">
  <meta itemprop="datePublished" content="2024-10-30T09:35:41+09:00">
  <meta itemprop="dateModified" content="2024-10-30T09:35:41+09:00">
  <meta itemprop="wordCount" content="700">
  <meta itemprop="keywords" content="서버오류,통신오류,CLOSE_WAIT,Connection,http/1.0,http/1.1,keep-alive,httpClient,통신규격,server failed">
	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">

        
        <script src="/js/lazysizes.min.js"></script>
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="국내 이곳저곳 여행지 및 카페, 아이와 함께 갈만한 곳을 소개합니다." rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">국내 이곳저곳 여행지 및 카페, 아이와 함께 갈만한 곳을 소개합니다.</div>
					
				</div>
		</a>
	</div>
		
<nav class="menu">
  <button class="menu__btn" aria-haspopup="true" aria-expanded="false" tabindex="0">
    <span class="menu__btn-title" tabindex="-1">Menu</span>
  </button>
  <ul class="menu__list">
    <li class="menu__item">
      <a class="menu__link" href="/">
        
          <span class="menu__text">Home</span>
        
      </a>
    </li>
    <li class="menu__item menu__dropdown">
      <a class="menu__link" href="/dev">
        
        <span class="menu__text">DEVELOPMENT</span>
        <label class="drop-icon" for="DEVELOPMENT">▾</label>
        
      </a>
      <input type="checkbox" id="DEVELOPMENT">
      <ul class="submenu__list">
        
          <li class="menu__item">
          <a class="menu__link" href="/categories/javascript">
            
            <span class="menu__text">Javascript</span>
            
          </a>
          </li>
        
          <li class="menu__item">
          <a class="menu__link" href="/categories/vue">
            
            <span class="menu__text">Vue</span>
            
          </a>
          </li>
        
          <li class="menu__item">
          <a class="menu__link" href="/categories/java">
            
            <span class="menu__text">Java</span>
            
          </a>
          </li>
        
          <li class="menu__item">
          <a class="menu__link" href="/categories/server">
            
            <span class="menu__text">Server</span>
            
          </a>
          </li>
        
          <li class="menu__item">
          <a class="menu__link" href="/categories/db">
            
            <span class="menu__text">Database</span>
            
          </a>
          </li>
        
          <li class="menu__item">
          <a class="menu__link" href="/categories/hugo">
            
            <span class="menu__text">HUGO</span>
            
          </a>
          </li>
        
          <li class="menu__item">
          <a class="menu__link" href="/categories/ide">
            
            <span class="menu__text">IDE</span>
            
          </a>
          </li>
        
      </ul>
    </li>
    <li class="menu__item menu__dropdown">
      <a class="menu__link" href="/life">
        
        <span class="menu__text">LIFE</span>
        <label class="drop-icon" for="LIFE">▾</label>
        
      </a>
      <input type="checkbox" id="LIFE">
      <ul class="submenu__list">
        
          <li class="menu__item">
          <a class="menu__link" href="/categories/places">
            
            <span class="menu__text">PLACES</span>
            
          </a>
          </li>
        
          <li class="menu__item">
          <a class="menu__link" href="/categories/everything">
            
            <span class="menu__text">EVERYTHING</span>
            
          </a>
          </li>
        
      </ul>
    </li>
  </ul>
</nav>


	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
        <article class="post autonumbering">
		<header class="post__header">
			<h1 class="post__title">The target server failed to respond (And.. HTTP/1.0, HTTP/1.1)</h1>
			<div class="post__meta meta">
<div class="meta__item-datetime meta__item">
	<svg class="meta__icon icon icon-time" width="16" height="14" viewBox="0 0 30 28"><path d="M15 0C7 0 1 6 1 14s6 14 14 14 14-6 14-14S23 0 15 0zm0 25C9 25 4 20 4 14S9 3 15 3s11 5 11 11-5 11-11 11zm1-18h-2v8.4l6.8 4.4L22 18l-6-3.8V7z"/></svg><time class="meta__text" datetime="2024-10-30T09:35:41&#43;09:00">2024-10-30 09:35:41</time></div><div class="meta__item-categories meta__item"><svg class="meta__icon icon icon-category" width="16" height="16" viewBox="0 0 16 16"><path d="m7 2l1 2h8v11h-16v-13z"/></svg><span class="meta__text"><a class="meta__link" href="/categories/server/" rel="category">Server</a>
	</span>
</div></div>
		</header>
		<div class="content post__content clearfix">
			<p> </p>
<p>최근 외부업체와의 통신 중에 아래와 같은 오류가 매우 자주 발생하는 것을 확인 할 수 있었습니다.</p>
<blockquote>
<p><strong>The target server failed to respond</strong></p>
</blockquote>
<p><strong>먼저 본문 포스트를 작성 하기 전에 위의 오류에 대한 해결은 아직 하지 못하였으며 아래는 HTTP/1.0, HTTP/1.1 에 관한 간략한 내용을 담는 글이라고 먼저 말씀드립니다.</strong></p>
<p>해당 오류가 해결이 된다면 바로 본문 게시글을 수정하도록 하겠습니다.</p>
<blockquote>
<p><strong>The target server failed to respond.</strong></p>
</blockquote>
<p>해당 오류는 HttpClient 방식을 통해 통신을 하는 중에 발생을 하였으며, 발견 당시 해당 오류에 대한 검색을 해보았습니다.</p>
<p>그러던 중 접한 정보가 HTTP 통신 규약인 <strong>HTTP/1.0</strong> 과 <strong>HTTP/1.1</strong> 입니다. </p>
<p>아래 해당 내용에 대해 작성하기 전 가장 의심이 가는 부분으로 의심되는 부분을 아래의 사이트에서 발견하였으며 정리를 간략히 해보도록 하겠습니다. ( 출처 : <a href="http://www.yunsobi.com/blog/i/entry/660">http://www.yunsobi.com/blog/i/entry/660</a> )</p>
<p> </p>
<p><em>이하 말을 좀 편하게 하겠습니다. (_ _)</em></p>
<p> </p>
<p>1. HttpClient 통신은 Default 가 HTTP/1.1 방식이다.</p>
<p>2. HTTP/1.1 방식이기 때문에 어느정도 Keep-Alive 가 보장된다.</p>
<p>3. Keep-Alive 가 보장되는 상태에서는 아래와 같은 사유로 위의 오류를 발생할 수 있게 된다.</p>
<p>3-1. Client 가 Server 와 Connection 을 생성하여 Request 를 보냄</p>
<p>3-2. Server 에서는 Client 의 요청을 처리하여 응답 후 Close 함</p>
<p> </p>
<p>문제는 3-2 의 상황 이후에 발생하게 된다. </p>
<p>3-2 상태로 남아있는 Server 측의 Close 상태에 대한 의미는 소켓 단절이 아닌 <code>더 이상 보낼 데이터가 없습니다.</code> 라는 상태이며 Client 측에서는 Connection 을 단절하지 않는 이상 해당 Connection 을 통하여 Server 로 부터 계속해서 데이터를 인입시킬 수 있다&gt;는 것이다.</p>
<p>이 상황을 <strong>Half-closed connection</strong> 으로 표현하며 TCP 가 이렇게 동작하게끔 설계되어 있으며 버그가 아니다. 그리고 이런 상황이 발생하게 되면 Client 의 JVM 상의 Connection 객체는 살아 있지만 내부소켓은 CLOSE_WAIT 상태가 된다.</p>
<p>이 상황에서 HttpClient 가 CLOSE_WAIT 상태인 이 Connection 객체를 다시 사용하려고 하면 서버측은 이미 연결이 끊긴 상태이기 때문에 해당 오류가 발생되게 되는 것이다. </p>
<p> </p>
<p>출처에 있는 글을 그대로 담아오다 보니 말이 조금 어려워 진 듯 한데 간단히 정리하면 이렇지 않을 까 싶다.<br>
 </p>
<p>1. CLIENT -&gt; SERVER 로 통신을 위한 CONNECTION 생성</p>
<p>2. SERVER -&gt; CLIENT 로 응답. <strong>SERVER 측은 CLOSE, CONNECTION 내부소켓은 CLOSE_WAIT 상태. CONNECTION 은 살아있음.</strong> (이해하기 쉽게 SERVER 측에서는 해당 연결을 끊었다고 보면 될 듯.)</p>
<p>3. CLIENT -&gt; SERVER 로 요청보냄 (<strong>Keep-Alive 로 인해 동일host:port에 대해 이전과 동일한 CONNECTION 객체를 사용하려하기 때문에 1번에서 생성한 CONNECTION 을 사용하려 함</strong>)</p>
<p>4. CLOSE_WAIT 상태인 CONNECTION 객체를 사용하여 SERVER 와의 통신을 시도하지만 이미 서버에서는 연결을 끊은 상황이기에 오류 발생.</p>
<p> </p>
<p>이렇기 때문에 해당 문제해결을 위해서는 통신완료된 CONNECTION 객체에 대해 쌓이지 않게 적절하게 제거해야 한다고 명시되어 있습니다. 해당 방법과 해결에 대해서는 본문 처음에 얘기한 대로 조치가 완료되면 업데이트 하도록 하겠습니다. </p>
<p> </p>
<p>다음으로 HTTP/1.0, HTTP/1.1 에 대해서 얘기해보도록 하겠습니다.</p>
<p>먼저, 위에서 계속해서 야기되고 뭔가 문제의 포인트라고 할 수 있는 Keep-Alive 란 HTTP/1.1 에 적용 된 </p>
<p><strong>매 Connection 마다 open, close 를 하지않고 timeout 동안은 Connection 을 Close 하지 말자</strong></p>
<p>​라는 것으로 HTTP/1.0 과의 다른 특징 중 하나이며 각각의 특징 및 장단점을 정리하자면 아래와 같습니다.<br>
아래 내용들의 출처는 <a href="http://pchun.tistory.com/60">http://pchun.tistory.com/60</a> 과 <a href="http://blog.naver.com/joebak/220442865840">http://blog.naver.com/joebak/220442865840</a> 이며 나름 이해할 수 있게 정리한 것입니다.</p>
<p> </p>
<p>** <strong>HTTP/1.0</strong></p>
<p>- client - server 1:1 개념</p>
<p>- 무조건 연결하고 끊는다. (connection less - 매번 socker(port) 를 열고 끊음.) </p>
<p>- throughput 이 제대로 안나옴.</p>
<p>- TIME_WAIT 발생 </p>
<p> -&gt; EX) A 회사에서 B 회사로 API 호출 시 A 회사 사이트에 같은 서버로 5명의 사용자가 붙어서 동일 API 호출 시</p>
<p>   5번째 사용자는 앞의 4번째 사용자들의 호출이 끝나야 호출 가능.</p>
<p>   A 회사가 client</p>
<p>   B 회사가 server 가 되는.</p>
<p>- 호출 시 마다 open 해야하고 접속, 재접속으로 인해 서버 과부하 및 TCP HandShake 비용이 많아짐</p>
<p> </p>
<p>** <strong>HTTP/1.1</strong></p>
<p>- client - server  n:1 개념 (같은 IP로 여러 요청이 동시에 들어 올 수 있는 점을 감안)</p>
<p>- keep-alive : 매 connection 마다 open, close 하는게 아니라 지정한 timeout 동안은 close 하지 않는 방식</p>
<p>- Keep-alive 를 사용하는 의미를 크게 만들기 위해선 NIO 방식인 Nginx 를 사용해야 한다고 함</p>
<p>- Apache 의 경우에는 매 커넥션마다 thread 를 생성하기 때문에 Persistent Connection 의미가 사라짐.</p>
<p> </p>
<p>* 추가로 <a href="http://pchun.tistory.com/60">http://pchun.tistory.com/60</a> 님의 블로그에서 본 The target server failed to respond 해결에 관한 방법 및 장단점을 옮겨 적어보도록 하겠습니다.</p>
<p> </p>
<p>1. cilent 측에서 http/1.0 으로 연결</p>
<p> -&gt; keep-alive 를 하지 않기에 http/1.0 의 단점을 고스란히 안음</p>
<p>2. httpclient 를 제한적으로 사용</p>
<p> -&gt; httpclient warpping 하는 하나의 클래스를 만들어 그 클래스에서 싱글톤 패턴을 이용하여 필요한 곳에서 호출하도록.</p>
<p> -&gt; 스레드 환경에서 한번에 여러군데 접속하고 싶을 때 문제가 발생</p>
<p> -&gt; MultiThreadedHttpConnectionManager 를 사용</p>
<p> -&gt; MultiThreadedHttpConnectionManager connectionManager = new MultiThreadedHttpConnectionManager();</p>
<p> HttpClient client = new HttpClient(connectionManager);</p>
<p>MultiThreadedHttpConnectionManager 에 따른 몇가지 옵션은 필요에 따라서 조절. 이렇게 하면 CLOSE_WAIT 상태가 계속해서 누적되지 않음.</p>
<p> </p>

		</div>
		<footer class="post__footer">
			

		</footer>
	</article>
</main>




  <section class="comments">
    <script src="https://utteranc.es/client.js"
        repo="someoneornobody/someoneornobody-comments"
        issue-term="pathname"
        label="✨💬✨"
        theme="github-light"
        crossorigin="anonymous"
        async>
    </script>
  </section>


			</div>
			<aside class="sidebar"><div class="widget-search widget">
  <form class="widget-search__form" role="search" method="get" action="https://someoneornobody.github.io/search">
    <label>
      <input class="widget-search__field" type="search" placeholder="SEARCH…" value="" name="s" aria-label="SEARCH…">
    </label>
    <input class="widget-search__submit" type="submit" value="Search">
  </form>
</div>

<div class="widget-categories widget">
	<h4 class="widget__title">Categories</h4>
	<div class="widget__content">
		<ul class="widget__list">
			<li class="widget__item">
				<a class="widget__link" href="/categories/db/">Db</a>&nbsp;
				<span class="widget__counter widget__counter--bubble">2</span>
				</li>
			<li class="widget__item">
				<a class="widget__link" href="/categories/everything/">Everything</a>&nbsp;
				<span class="widget__counter widget__counter--bubble">1</span>
				</li>
			<li class="widget__item">
				<a class="widget__link" href="/categories/hugo/">Hugo</a>&nbsp;
				<span class="widget__counter widget__counter--bubble">3</span>
				</li>
			<li class="widget__item">
				<a class="widget__link" href="/categories/ide/">Ide</a>&nbsp;
				<span class="widget__counter widget__counter--bubble">1</span>
				</li>
			<li class="widget__item">
				<a class="widget__link" href="/categories/java/">Java</a>&nbsp;
				<span class="widget__counter widget__counter--bubble">1</span>
				</li>
			<li class="widget__item">
				<a class="widget__link" href="/categories/javascript/">Javascript</a>&nbsp;
				<span class="widget__counter widget__counter--bubble">2</span>
				</li>
			<li class="widget__item">
				<a class="widget__link" href="/categories/places/">Places</a>&nbsp;
				<span class="widget__counter widget__counter--bubble">10</span>
				</li>
			<li class="widget__item">
				<a class="widget__link" href="/categories/server/">Server</a>&nbsp;
				<span class="widget__counter widget__counter--bubble">2</span>
				</li>
			<li class="widget__item">
				<a class="widget__link" href="/categories/vue/">Vue</a>&nbsp;
				<span class="widget__counter widget__counter--bubble">6</span>
				</li>
		</ul>
	</div>
</div>
<div class="widget-recent widget">
	<h4 class="widget__title">Recent Posts</h4>
	<div class="widget__content">
		<ul class="widget__list">
			<li class="widget__item"><a class="widget__link" href="/dev/java/sort-array-hashmap/">[JAVA] List&lt;HashMap&lt;String, String&gt;&gt; 정렬</a></li>
			<li class="widget__item"><a class="widget__link" href="/life/everything/neve-di-camaldoli/">크레마 네베 디 카말돌리 크림(NEVE DI CAMALDOLI) 초간단 사용후기..</a></li>
			<li class="widget__item"><a class="widget__link" href="/dev/server/target-server-failed-to-respond/">The target server failed to respond (And.. HTTP/1.0, HTTP/1.1)</a></li>
			<li class="widget__item"><a class="widget__link" href="/dev/ide/intellij-broken-kor/">[IDE] 콘솔 한글깨짐 처리 (console log encoding .. with tomcat)</a></li>
			<li class="widget__item"><a class="widget__link" href="/dev/javascript/use-href-onclick-into-anchor/">[javascript] A 태그(Anchor) 에서의 href, onclick 사용</a></li>
		</ul>
	</div>
</div>
</aside>
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 doproperly.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>
